(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-chat_detail"],{"03a4":function(t,e,i){"use strict";i.r(e);var a=i("0e0e"),n=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);e["default"]=n.a},"0e0e":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("c5f6");var a={props:{message:{type:Object,default:function(){return{}}},cid:{type:[Number,String],default:""}}};e.default=a},"1b11":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".uni-column[data-v-007dfdfa]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.content[data-v-007dfdfa]{background-color:#f5f5f5;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;margin-bottom:%?100?%}.foot[data-v-007dfdfa]{position:fixed;width:100%;height:%?90?%;min-height:%?90?%;left:%?0?%;bottom:%?0?%;overflow:hidden}",""])},"377e":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={name:"chat-input",data:function(){return{inputValue:""}},methods:{startRecognize:function(){var t={},e=this;t.engine="iFly",e.inputValue="",plus.speech.startRecognize(t,function(t){console.log(t),e.inputValue+=t},function(t){console.log("语音识别失败："+t.message)})},sendMessge:function(){var t=this;""==t.inputValue.trim()?t.inputValue="":(this.$emit("send-message",{type:"text",content:t.inputValue}),t.inputValue="")}}};e.default=a},"4e63":function(t,e,i){"use strict";var a=i("e8bb"),n=i.n(a);n.a},5482:function(t,e,i){var a=i("970b");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("683f314f",a,!0,{sourceMap:!1,shadowMode:!1})},"55e4":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"footer"},[i("v-uni-view",{staticClass:"footer-left"},[i("v-uni-view",{staticClass:"uni-icon uni-icon-mic",on:{click:function(e){e=t.$handleEvent(e),t.startRecognize(e)}}})],1),i("v-uni-view",{staticClass:"footer-center"},[i("v-uni-input",{staticClass:"input-text",attrs:{type:"text"},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}})],1),i("v-uni-view",{staticClass:"footer-right",on:{click:function(e){e=t.$handleEvent(e),t.sendMessge(e)}}},[i("v-uni-view",{attrs:{id:"msg-type"}},[t._v("发送")])],1)],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},5999:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"m-item",attrs:{id:"message"+t.cid}},[i("v-uni-view",{staticClass:"m-left"},[t.message.mine?t._e():i("v-uni-image",{staticClass:"head_icon",attrs:{src:t.$T.getPath(t.message.avatar)}})],1),i("v-uni-view",{staticClass:"m-content"},[i("v-uni-view",{staticClass:"m-content-head",class:{"m-content-head-right":t.message.mine}},[i("v-uni-view",{class:!0!==t.message.mine?"m-content-head-home":"m-content-head-customer"},[1===t.message.msg_type?i("v-uni-view",[t._v(t._s(t.message.msg))]):i("v-uni-view",[i("v-uni-image",{staticStyle:{"max-width":"300rpx","max-height":"300rpx","border-radius":"2%"},attrs:{src:t.$T.getPath(t.message.msg)}})],1)],1)],1)],1),i("v-uni-view",{staticClass:"m-right"},[t.message.mine?i("v-uni-image",{staticClass:"head_icon",attrs:{src:t.$T.getPath(t.message.avatar)}}):t._e()],1)],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},"785d":function(t,e,i){"use strict";i.r(e);var a=i("377e"),n=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);e["default"]=n.a},"808c":function(t,e,i){"use strict";i.r(e);var a=i("f74f"),n=i("e105");for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);i("4e63");var s=i("2877"),c=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,"007dfdfa",null);e["default"]=c.exports},"970b":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,'.m-item[data-v-4f46e820]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;padding-top:%?40?%}.m-left[data-v-4f46e820]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:%?120?%;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start}.m-content[data-v-4f46e820]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;word-break:break-all}.m-right[data-v-4f46e820]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;width:%?120?%;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start}.head_icon[data-v-4f46e820]{width:%?80?%;height:%?80?%;border-radius:%?10?%}.m-content-head[data-v-4f46e820]{position:relative}.m-content-head-right[data-v-4f46e820]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:end;-webkit-justify-content:flex-end;-ms-flex-pack:end;justify-content:flex-end}.m-content-head-home[data-v-4f46e820]{text-align:left;background:#fff;border:1px #fff solid;border-radius:%?10?%;padding:%?16?%;color:#000;display:inline-block}.m-content-head-home[data-v-4f46e820]:before{border:%?15?% solid rgba(0,0,0,0);border-right:%?15?% solid #fff;left:%?-26?%;width:0;height:0;position:absolute;content:" "}.m-content-head-customer[data-v-4f46e820]{border:%?1?% #fff solid;background:#96eb6a;border-radius:%?10?%;padding:%?16?%}.m-content-head-customer[data-v-4f46e820]:after{border:%?15?% solid rgba(0,0,0,0);border-left:%?15?% solid #96eb6a;top:%?20?%;right:%?-26?%;width:0;height:0;position:absolute;content:" "}',""])},"9ae8":function(t,e,i){"use strict";i.r(e);var a=i("55e4"),n=i("785d");for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);i("f0d5");var s=i("2877"),c=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,"3f91685c",null);e["default"]=c.exports},b7b6:function(t,e,i){"use strict";i.r(e);var a=i("5999"),n=i("03a4");for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);i("f29b");var s=i("2877"),c=Object(s["a"])(n["default"],a["a"],a["b"],!1,null,"4f46e820",null);e["default"]=c.exports},c5f5:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".footer[data-v-3f91685c]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;width:100%;height:%?80?%;min-height:%?80?%;border-top:solid 1px #bbb;overflow:hidden;padding:%?5?%;background-color:#fafafa}.footer-left[data-v-3f91685c]{width:%?80?%;height:%?80?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.footer-right[data-v-3f91685c]{width:%?120?%;height:%?80?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;color:#1482d1}.footer-center[data-v-3f91685c]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;height:%?80?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.footer-center .input-text[data-v-3f91685c]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1;background:#fff;border:solid %?1?% #ddd;padding:%?10?%!important;font-family:verdana!important;overflow:hidden;border-radius:%?15?%}",""])},d54e:function(t,e,i){"use strict";var a=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("ac6a");var n=a(i("f499")),o=a(i("e814")),s=a(i("9ae8")),c=a(i("b7b6")),r=!1,l={data:function(){return{name:"xcecd@qq.com",style:{pageHeight:0,contentViewHeight:0,footViewHeight:90,mitemHeight:0},scrollTop:0,chatData:{to_uid:0,chat_id:"",chat_type:1,msg_type:1,shop_id:0},imList:[]}},components:{chatInput:s.default,messageShow:c.default},onLoad:function(t){var e=uni.getSystemInfoSync();this.style.pageHeight=e.windowHeight,this.style.contentViewHeight=e.windowHeight-uni.getSystemInfoSync().screenWidth/750*100,this.scrollToBottom();var i=this;r=uni.getStorageSync("isService"),t.to_uid&&(i.chatData.to_uid=(0,o.default)(t.to_uid)),t.chat_id&&(i.chatData.chat_id=t.chat_id),t.chat_type&&(i.chatData.chat_type=(0,o.default)(t.chat_type)),t.shop_id&&(i.chatData.shop_id=(0,o.default)(t.shop_id),i.chatData.chat_type=4),t.friend_name&&uni.setNavigationBarTitle({title:t.friend_name})},onShow:function(){this.getChatRecord()},methods:{getChatRecord:function(){var t,e=this;t=e.chatData.chat_id?{chat_id:e.chatData.chat_id}:{to_uid:e.chatData.to_uid,chat_type:e.chatData.chat_type},uni.request({url:e.$T.DOMAIN+"user/getChatRecord",method:"post",data:t,header:{authorizations:"bear "+uni.getStorageSync("auth_token")},success:function(t){var i=t.data;i.code&&(e.imList=i.result.rows.reverse())}})},getInputMessage:function(t){if(!t.content)return!1;var e=this,i=uni.getStorageSync("mine");e.chatData.msg_type=1,e.chatData.msg=t.content,e.chatData.role_type=4===e.chatData.chat_type&&r?1:0,uni.sendSocketMessage({data:(0,n.default)({class:"chat",action:"sendMsg",content:e.chatData})}),this.addMessage(!0,i.avatar,t.content,e.chatData.msg_type)},addMessage:function(t,e,i,a){var n=this;n.imList.push({mine:t,avatar:e,msg:i,msg_type:a})},scrollToBottom:function(){var t=this,e=uni.createSelectorQuery();e.selectAll(".m-item").boundingClientRect(),e.select("#scrollview").boundingClientRect(),e.exec(function(e){t.style.mitemHeight=0,e[0].forEach(function(e){t.style.mitemHeight=t.style.mitemHeight+e.height+20}),t.style.mitemHeight>t.style.contentViewHeight&&(t.scrollTop=t.style.mitemHeight-t.style.contentViewHeight)})},getNewMsg:function(t){t.service_nickname&&(t.nickname=t.service_nickname,t.avatar=t.service_avatar),this.addMessage(!1,t.avatar,t.msg,t.msg_type);var e={chat_id:t.chat_id,role_type:4===t.chat_type&&r?1:0};uni.sendSocketMessage({data:(0,n.default)({class:"chat",action:"setChatRead",content:e})})}}};e.default=l},da2f:function(t,e,i){var a=i("c5f5");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("5d0af9a5",a,!0,{sourceMap:!1,shadowMode:!1})},e105:function(t,e,i){"use strict";i.r(e);var a=i("d54e"),n=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);e["default"]=n.a},e8bb:function(t,e,i){var a=i("1b11");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("63e47c26",a,!0,{sourceMap:!1,shadowMode:!1})},f0d5:function(t,e,i){"use strict";var a=i("da2f"),n=i.n(a);n.a},f29b:function(t,e,i){"use strict";var a=i("5482"),n=i.n(a);n.a},f74f:function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"uni-column"},[i("v-uni-view",{staticClass:"content",style:{height:t.style.contentViewHeight+"px"},attrs:{id:"content"}},[i("v-uni-scroll-view",{style:{height:t.style.contentViewHeight+"px"},attrs:{id:"scrollview","scroll-y":"true","scroll-with-animation":!0,"scroll-top":t.scrollTop}},[t._l(t.imList,function(t,e){return i("message-show",{key:e,attrs:{message:t,cid:e}})}),i("v-uni-view",{attrs:{id:"bottom"}})],2)],1),i("v-uni-view",{staticClass:"foot"},[i("chat-input",{on:{"send-message":function(e){e=t.$handleEvent(e),t.getInputMessage(e)},focus:function(e){e=t.$handleEvent(e),t.inputGetFocus(e)}}})],1)],1)},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})}}]);