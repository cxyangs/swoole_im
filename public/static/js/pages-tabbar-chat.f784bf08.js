(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-tabbar-chat"],{"0256":function(t,e,i){"use strict";i.r(e);var n=i("1c34"),a=i("5758");for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);i("f80a");var r=i("2877"),s=Object(r["a"])(a["default"],n["a"],n["b"],!1,null,"69153ab0",null);e["default"]=s.exports},"1c34":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"uni-swipe-action"},[i("v-uni-view",{staticClass:"uni-swipe-action__container",class:{"uni-swipe-action--show":t.isShowBtn},style:{transform:t.transformX,"-webkit-transform":t.transformX},on:{touchstart:function(e){e=t.$handleEvent(e),t.touchStart(e)},touchmove:function(e){e=t.$handleEvent(e),t.touchMove(e)},touchend:function(e){e=t.$handleEvent(e),t.touchEnd(e)},touchcancel:function(e){e=t.$handleEvent(e),t.touchEnd(e)},click:function(e){e=t.$handleEvent(e),t.bindClickCont(e)}}},[i("v-uni-view",{staticClass:"uni-swipe-action__content"},[t._t("default")],2),i("v-uni-view",{staticClass:"uni-swipe-action__btn-group",attrs:{id:t.elId}},t._l(t.options,function(e,n){return i("div",{key:n,staticClass:"uni-swipe-action--btn",style:{backgroundColor:e.style&&e.style.backgroundColor?e.style.backgroundColor:"#C7C6CD",color:e.style&&e.style.color?e.style.color:"#FFFFFF",fontSize:e.style&&e.style.fontSize?e.style.fontSize:"28upx"},on:{click:function(i){i=t.$handleEvent(i),t.bindClickBtn(e,n)}}},[t._v(t._s(e.text))])}),0)],1),t.isShowBtn?i("v-uni-view",{staticClass:"uni-swipe-action__mask",on:{click:function(e){e=t.$handleEvent(e),t.close(e)},touchmove:function(e){e.stopPropagation(),e.preventDefault(),e=t.$handleEvent(e),t.close(e)}}}):t._e()],1)},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},"278b":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.chatList.length?i("v-uni-view",{staticClass:"im-item"},t._l(t.chatList,function(e,n){return i("v-uni-view",{key:n,staticClass:"touch-item"},[i("uni-swipe-action",{attrs:{options:t.swipeOptions},on:{click:function(i){i=t.$handleEvent(i),t.bindClickSwipe(i,e,n)}}},[i("v-uni-view",{staticClass:"cart-content"},[i("v-uni-view",{staticClass:"content",on:{click:function(i){i=t.$handleEvent(i),t.toChatDetail(e,n)}}},[i("v-uni-image",{staticClass:"logo",attrs:{src:e.friend_avatar}}),i("v-uni-view",{staticClass:"wrap"},[i("v-uni-view",{staticClass:"van-ellipsis title-o",domProps:{textContent:t._s(e.friend_name)}}),i("v-uni-view",{staticClass:"van-ellipsis content-o",domProps:{textContent:t._s(e.last_msg)}})],1),i("v-uni-view",{staticStyle:{"max-width":"135rpx","min-width":"80rpx","text-align":"right"}},[i("v-uni-view",{staticClass:"time-o",domProps:{textContent:t._s(t.$T.chatFormatDate(e.last_time))}}),e.unread_count?i("uni-badge",{attrs:{text:e.unread_count.toString(),type:"error"}}):t._e()],1)],1)],1)],1)],1)}),1):i("v-uni-view",{staticClass:"default-content"},[i("v-uni-image",{staticClass:"pic",staticStyle:{width:"280rpx",height:"200rpx"},attrs:{src:"/static/img/default-nodata.png"}}),i("v-uni-view",{staticClass:"info"},[t._v("您还没有相关的聊天")])],1)},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},"2ceb":function(t,e,i){"use strict";var n=i("5866"),a=i.n(n);a.a},3045:function(t,e,i){"use strict";i.r(e);var n=i("278b"),a=i("5bef");for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);i("2ceb");var r=i("2877"),s=Object(r["a"])(a["default"],n["a"],n["b"],!1,null,"f4069e1e",null);e["default"]=s.exports},"37f2":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".uni-swipe-action[data-v-69153ab0]{width:100%;overflow:hidden}.uni-swipe-action__container[data-v-69153ab0]{position:relative;background-color:#fff;width:200%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-transition:-webkit-transform .35s cubic-bezier(.165,.84,.44,1);transition:-webkit-transform .35s cubic-bezier(.165,.84,.44,1);-o-transition:transform .35s cubic-bezier(.165,.84,.44,1);transition:transform .35s cubic-bezier(.165,.84,.44,1);transition:transform .35s cubic-bezier(.165,.84,.44,1),-webkit-transform .35s cubic-bezier(.165,.84,.44,1)}.uni-swipe-action__content[data-v-69153ab0]{width:50%}.uni-swipe-action__btn-group[data-v-69153ab0]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row}.uni-swipe-action--show[data-v-69153ab0]{position:relative;z-index:1000}.uni-swipe-action--btn[data-v-69153ab0]{padding:0 %?32?%;color:#fff;background-color:#c7c6cd;font-size:%?28?%;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;text-align:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.uni-swipe-action__mask[data-v-69153ab0]{display:block;opacity:0;position:fixed;z-index:999;top:0;left:0;width:100%;height:100%}",""])},"415c":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".uni-badge[data-v-f69f3474]{font-family:Helvetica Neue,Helvetica,sans-serif;-webkit-box-sizing:border-box;box-sizing:border-box;font-size:12px;line-height:1;display:inline-block;padding:3px 6px;color:#333;border-radius:100px;background-color:#f1f1f1}.uni-badge.uni-badge-inverted[data-v-f69f3474]{padding:0 5px 0 0;color:#999;background-color:rgba(0,0,0,0)}.uni-badge-primary[data-v-f69f3474]{color:#fff;background-color:#007aff}.uni-badge-primary.uni-badge-inverted[data-v-f69f3474]{color:#007aff;background-color:rgba(0,0,0,0)}.uni-badge-success[data-v-f69f3474]{color:#fff;background-color:#4cd964}.uni-badge-success.uni-badge-inverted[data-v-f69f3474]{color:#4cd964;background-color:rgba(0,0,0,0)}.uni-badge-warning[data-v-f69f3474]{color:#fff;background-color:#f0ad4e}.uni-badge-warning.uni-badge-inverted[data-v-f69f3474]{color:#f0ad4e;background-color:rgba(0,0,0,0)}.uni-badge-error[data-v-f69f3474]{color:#fff;background-color:#dd524d}.uni-badge-error.uni-badge-inverted[data-v-f69f3474]{color:#dd524d;background-color:rgba(0,0,0,0)}.uni-badge--small[data-v-f69f3474]{-webkit-transform:scale(.8);-ms-transform:scale(.8);transform:scale(.8);-webkit-transform-origin:center center;-ms-transform-origin:center center;transform-origin:center center}",""])},5758:function(t,e,i){"use strict";i.r(e);var n=i("a4ea"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e["default"]=a.a},5866:function(t,e,i){var n=i("d15b");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("20866a35",n,!0,{sourceMap:!1,shadowMode:!1})},"5bef":function(t,e,i){"use strict";i.r(e);var n=i("d792"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e["default"]=a.a},"5da6":function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.text?i("v-uni-text",{staticClass:"uni-badge",class:t.inverted?"uni-badge-"+t.type+" uni-badge--"+t.size+" uni-badge-inverted":"uni-badge-"+t.type+" uni-badge--"+t.size,on:{click:function(e){e=t.$handleEvent(e),t.onClick()}}},[t._v(t._s(t.text))]):t._e()},a=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return a})},7165:function(t,e,i){var n=i("37f2");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("7d1318a0",n,!0,{sourceMap:!1,shadowMode:!1})},7472:function(t,e,i){"use strict";i.r(e);var n=i("c503"),a=i.n(n);for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);e["default"]=a.a},"9f4f":function(t,e,i){var n=i("415c");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var a=i("4f06").default;a("2c45adac",n,!0,{sourceMap:!1,shadowMode:!1})},a4ea:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("c5f6"),i("6b54"),i("87b3");var n={name:"UniSwipeAction",props:{isDrag:{type:Boolean,default:!1},isOpened:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},autoClose:{type:Boolean,default:!0},options:{type:Array,default:function(){return[]}}},data:function(){var t="Uni_".concat(Math.ceil(1e6*Math.random()).toString(36));return{elId:t,isShowBtn:!1,transformX:"translateX(0px)"}},watch:{isOpened:function(t,e){this.isShowBtn=!!t,this.endMove()}},created:function(){this.direction="",this.startX=0,this.startY=0,this.btnGroupWidth=0,this.isMoving=!1,this.startTime=0},mounted:function(){this.getSize()},methods:{getSize:function(){var t=this;uni.createSelectorQuery().in(this).select("#".concat(this.elId)).boundingClientRect().exec(function(e){t.btnGroupWidth=e[0].width}),!0===this.isOpened&&(this.isShowBtn=!0,this.endMove())},bindClickBtn:function(t,e){this.$emit("click",{text:t.text,style:t.style,index:e})},bindClickCont:function(t){this.isShowBtn&&!0===this.autoClose&&(this.isShowBtn=!1,this.endMove())},touchStart:function(t){this.startTime=t.timeStamp,this.startX=t.touches[0].pageX,this.startY=t.touches[0].pageY},touchMove:function(t){if("Y"!==this.direction&&!0!==this.disabled){var e=t.touches[0].pageY-this.startY,i=t.touches[0].pageX-this.startX;if(!this.isMoving&&Math.abs(e)>Math.abs(i))this.direction="Y";else if(this.direction=i>0?"right":"left",this.isMoving=!0,this.isDrag){var n=this.isShowBtn?-this.btnGroupWidth:0;if(n+i>=0)return void(this.transformX="translateX(0px)");if(-n-i>=this.btnGroupWidth)return void(this.transformX="translateX(".concat(-this.btnGroupWidth,"px)"));n-i>0?this.transformX="translateX(".concat(i,"px)"):i>=-this.btnGroupWidth&&(this.transformX="translateX(".concat(i-this.btnGroupWidth,"px)"))}}},touchEnd:function(t){if(this.isMoving=!1,"right"===this.direction||"left"===this.direction){if(this.isDrag){var e=Math.abs(Number(this.transformX.slice(11,-3))),i=t.timeStamp-this.startTime;this.isShowBtn=e>=this.btnGroupWidth/2,i>50&&i<300&&e>20&&("right"===this.direction?this.isShowBtn=!1:this.isShowBtn=!0)}else"right"===this.direction?this.isShowBtn=!1:this.isShowBtn=!0;this.endMove()}else this.direction=""},endMove:function(){"Y"!==this.direction&&!0!==this.disabled?(this.isShowBtn?(this.transformX="translateX(".concat(-this.btnGroupWidth,"px)"),this.$emit("opened")):(this.transformX="translateX(0px)",this.$emit("closed")),this.direction=""):this.direction=""},close:function(){this.isShowBtn=!1,this.endMove()}}};e.default=n},c249:function(t,e,i){"use strict";i.r(e);var n=i("5da6"),a=i("7472");for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);i("faf5");var r=i("2877"),s=Object(r["a"])(a["default"],n["a"],n["b"],!1,null,"f69f3474",null);e["default"]=s.exports},c503:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"UniBadge",props:{type:{type:String,default:"default"},inverted:{type:Boolean,default:!1},text:{type:String,default:""},size:{type:String,default:"normal"}},methods:{onClick:function(){this.$emit("click")}}};e.default=n},d15b:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".default-content[data-v-f4069e1e]{padding-top:%?300?%}.default-content .pic[data-v-f4069e1e]{display:block;width:%?240?%;height:%?240?%;margin:0 auto}.default-content .pics[data-v-f4069e1e]{display:block;width:%?320?%;height:%?240?%;margin:0 auto}.default-content .info[data-v-f4069e1e]{font-size:%?28?%;padding:11px 15px;color:#333;text-align:center}uni-page-body[data-v-f4069e1e]{background:#fff}.im-item[data-v-f4069e1e]{width:100%}.im-item .content[data-v-f4069e1e]{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex}.im-item .logo[data-v-f4069e1e]{width:%?80?%;height:%?80?%;border-radius:50%;margin-right:%?20?%}.im-item .wrap[data-v-f4069e1e]{-webkit-box-flex:1;-webkit-flex:1;-ms-flex:1;flex:1}.im-item .title-o[data-v-f4069e1e]{max-width:%?440?%;font-size:%?28?%;color:#333}.im-item .content-o[data-v-f4069e1e]{max-width:%?440?%;font-size:%?24?%;color:#999}.im-item .time-o[data-v-f4069e1e]{font-size:%?24?%;color:#999}.touch-item[data-v-f4069e1e]{font-size:14px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;width:100%;overflow:hidden;border-bottom:%?1?% solid #f2f2f1}.cart-content[data-v-f4069e1e]{-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;padding:%?20?%;line-height:%?40?%;margin-right:0;-webkit-transition:all .4s;-o-transition:all .4s;transition:all .4s;-webkit-transform:translateX(90px);-ms-transform:translateX(90px);transform:translateX(90px);margin-left:-90px}.del[data-v-f4069e1e]{background-color:#ff4500;width:%?180?%;font-size:%?28?%;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;color:#fff;-webkit-transform:translateX(%?180?%);-ms-transform:translateX(%?180?%);transform:translateX(%?180?%);-webkit-transition:all .4s;-o-transition:all .4s;transition:all .4s}.touch-move-active .cart-content[data-v-f4069e1e],.touch-move-active .del[data-v-f4069e1e]{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}body.?%PAGE?%[data-v-f4069e1e]{background:#fff}",""])},d792:function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n(i("f499"));i("6b54"),i("87b3");var o=n(i("0256")),r=n(i("c249")),s=!1,c={components:{uniSwipeAction:o.default,uniBadge:r.default},data:function(){return{unread_count:0,swipeOptions:[{text:"取消",style:{backgroundColor:"#cccccc"}},{text:"删除",style:{backgroundColor:"#FF3A31"}}],chatList:[]}},onLoad:function(t){s=uni.getStorageSync("isService"),this.getChat();var e=this;uni.onSocketMessage(function(t){console.log(11111);var i=JSON.parse(t.data);200===i.code&&e.getChat()})},onShow:function(){this.getChat()},onReady:function(){},methods:{getChat:function(){var t=this;uni.request({url:t.$T.DOMAIN+"user/chatRecently",method:"post",data:{is_service:s},header:{authorizations:"bear "+uni.getStorageSync("auth_token")},success:function(e){var i=e.data;if(i.code){t.unread_count=i.result.unread_count,t.setTotalUnreadNum();var n=i.result.rows;t.chatList=n}}})},setTotalUnreadNum:function(){1*!this.unread_count?uni.removeTabBarBadge({index:0}):uni.setTabBarBadge({index:0,text:this.unread_count.toString()})},bindClickSwipe:function(t,e,i){1===t.index&&(this.unread_count-=e.unread_count,this.setTotalUnreadNum(),this.chatList.splice(i,1))},toChatDetail:function(t,e){var i=this;i.unread_count-=t.unread_count,i.setTotalUnreadNum();var n={chat_id:t.chat_id,role_type:4===t.chat_type&&s?1:0};uni.navigateTo({url:"/pages/chat_detail?chat_id="+t.chat_id+"&chat_type="+t.chat_type+"&friend_name="+t.friend_name+"&to_uid="+t.friend_uid,success:function(){t.unread_count&&uni.sendSocketMessage({data:(0,a.default)({class:"chat",action:"setChatRead",content:n})})}}),t.unread_count=0}}};e.default=c},f80a:function(t,e,i){"use strict";var n=i("7165"),a=i.n(n);a.a},faf5:function(t,e,i){"use strict";var n=i("9f4f"),a=i.n(n);a.a}}]);